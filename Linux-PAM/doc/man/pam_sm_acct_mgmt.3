.\"     Title: pam_sm_acct_mgmt
.\"    Author: 
.\" Generator: DocBook XSL Stylesheets v1.70.1 <http://docbook.sf.net/>
.\"      Date: 06/27/2006
.\"    Manual: Linux\-PAM Manual
.\"    Source: Linux\-PAM Manual
.\"
.TH "PAM_SM_ACCT_MGMT" "3" "06/27/2006" "Linux\-PAM Manual" "Linux\-PAM Manual"
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.SH "NAME"
pam_sm_acct_mgmt \- PAM service function for account management
.SH "SYNOPSIS"
.sp
.ft B
.nf
#define PAM_SM_ACCOUNT
.fi
.ft
.sp
.ft B
.nf
#include <security/pam_modules.h>
.fi
.ft
.HP 32
.BI "PAM_EXTERN int pam_sm_acct_mgmt(pam_handle_t\ *" "pamh" ", int\ " "flags" ", int\ " "argc" ", const\ char\ **" "argv" ");"
.SH "DESCRIPTION"
.PP
The
\fBpam_sm_acct_mgmt\fR
function is the service module's implementation of the
\fBpam_acct_mgmt\fR(3)
interface.
.PP
This function performs the task of establishing whether the user is permitted to gain access at this time. It should be understood that the user has previously been validated by an authentication module. This function checks for other things. Such things might be: the time of day or the date, the terminal line, remote hostname, etc. This function may also determine things like the expiration on passwords, and respond that the user change it before continuing.
.PP
Valid flags, which may be logically OR'd with
\fIPAM_SILENT\fR, are:
.TP 3n
PAM_SILENT
Do not emit any messages.
.TP 3n
PAM_DISALLOW_NULL_AUTHTOK
Return
\fBPAM_AUTH_ERR\fR
if the database of authentication tokens for this authentication mechanism has a
\fINULL\fR
entry for the user.
.SH "RETURN VALUES"
.TP 3n
PAM_ACCT_EXPIRED
User account has expired.
.TP 3n
PAM_AUTH_ERR
Authentication failure.
.TP 3n
PAM_NEW_AUTHTOK_REQD
The user's authentication token has expired. Before calling this function again the application will arrange for a new one to be given. This will likely result in a call to
\fBpam_sm_chauthtok()\fR.
.TP 3n
PAM_PERM_DENIED
Permission denied.
.TP 3n
PAM_SUCCESS
The authentication token was successfully updated.
.TP 3n
PAM_USER_UNKNOWN
User unknown to password service.
.SH "SEE ALSO"
.PP

\fBpam\fR(3),
\fBpam_acct_mgmt\fR(3),
\fBpam_sm_chauthtok\fR(3),
\fBpam_strerror\fR(3),
\fBPAM\fR(8)
