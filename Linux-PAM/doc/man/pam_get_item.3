.\"     Title: pam_get_item
.\"    Author: 
.\" Generator: DocBook XSL Stylesheets v1.70.1 <http://docbook.sf.net/>
.\"      Date: 06/27/2006
.\"    Manual: Linux\-PAM Manual
.\"    Source: Linux\-PAM Manual
.\"
.TH "PAM_GET_ITEM" "3" "06/27/2006" "Linux\-PAM Manual" "Linux\-PAM Manual"
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.SH "NAME"
pam_get_item \- getting PAM informations
.SH "SYNOPSIS"
.sp
.ft B
.nf
#include <security/pam_modules.h>
.fi
.ft
.HP 17
.BI "int pam_get_item(const\ pam_handle_t\ *" "pamh" ", int\ " "item_type" ", const\ void\ **" "item" ");"
.SH "DESCRIPTION"
.PP
The
\fBpam_get_item\fR
function allows applications and PAM service modules to access and retrieve PAM informations of
\fIitem_type\fR. Upon successful return,
\fIitem\fR
contains a pointer to the value of the corresponding item. Note, this is a pointer to the
\fIactual\fR
data and should
\fBnot\fR
be
\fIfree()\fR'ed or over\-written! The following values are supported for
\fIitem_type\fR:
.TP 3n
PAM_SERVICE
The service name (which identifies that PAM stack that the PAM functions will use to authenticate the program).
.TP 3n
PAM_USER
The username of the entity under whose identity service will be given. That is, following authentication,
\fIPAM_USER\fR
identifies the local entity that gets to use the service. Note, this value can be mapped from something (eg., "anonymous") to something else (eg. "guest119") by any module in the PAM stack. As such an application should consult the value of
\fIPAM_USER\fR
after each call to a PAM function.
.TP 3n
PAM_USER_PROMPT
The string used when prompting for a user's name. The default value for this string is a localized version of "login: ".
.TP 3n
PAM_TTY
The terminal name: prefixed by
\fI/dev/\fR
if it is a device file; for graphical, X\-based, applications the value for this item should be the
\fI$DISPLAY\fR
variable.
.TP 3n
PAM_RUSER
The requesting user name: local name for a locally requesting user or a remote user name for a remote requesting user.
.sp
Generally an application or module will attempt to supply the value that is most strongly authenticated (a local account before a remote one. The level of trust in this value is embodied in the actual authentication stack associated with the application, so it is ultimately at the discretion of the system administrator.
.sp

\fIPAM_RUSER@PAM_RHOST\fR
should always identify the requesting user. In some cases,
\fIPAM_RUSER\fR
may be NULL. In such situations, it is unclear who the requesting entity is.
.TP 3n
PAM_RHOST
The requesting hostname (the hostname of the machine from which the
\fIPAM_RUSER\fR
entity is requesting service). That is
\fIPAM_RUSER@PAM_RHOST\fR
does identify the requesting user. In some applications,
\fIPAM_RHOST\fR
may be NULL. In such situations, it is unclear where the authentication request is originating from.
.TP 3n
PAM_AUTHTOK
The authentication token (often a password). This token should be ignored by all module functions besides
\fBpam_sm_authenticate\fR(3)
and
\fBpam_sm_chauthtok\fR(3). In the former function it is used to pass the most recent authentication token from one stacked module to another. In the latter function the token is used for another purpose. It contains the currently active authentication token.
.TP 3n
PAM_OLDAUTHTOK
The old authentication token. This token should be ignored by all module functions except
\fBpam_sm_chauthtok\fR(3).
.TP 3n
PAM_CONV
The pam_conv structure. See
\fBpam_conv\fR(3).
.TP 3n
PAM_FAIL_DELAY
A function pointer to redirect centrally managed failure delays. See
\fBpam_fail_delay\fR(3).
.PP
If a service module wishes to obtain the name of the user, it should not use this function, but instead perform a call to
\fBpam_get_user\fR(3).
.PP
Only a service module is privileged to read the authentication tokens, PAM_AUTHTOK and PAM_OLDAUTHTOK.
.SH "RETURN VALUES"
.TP 3n
PAM_BAD_ITEM
The application attempted to set an undefined or inaccessible item.
.TP 3n
PAM_BUF_ERR
Memory buffer error.
.TP 3n
PAM_PERM_DENIED
The value of
\fIitem\fR
was NULL.
.TP 3n
PAM_SUCCESS
Data was successful updated.
.TP 3n
PAM_SYSTEM_ERR
The
\fIpam_handle_t\fR
passed as first argument was invalid.
.SH "SEE ALSO"
.PP

\fBpam_set_item\fR(3),
\fBpam_strerror\fR(3)
